<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Syllabus Tracker</title>

    <!-- Firebase SDKs (compat) -->
    <script src="https://www.gstatic.com/firebasejs/9.6.10/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.6.10/firebase-firestore-compat.js"></script>

    <style>
        body {
            font-family: Arial, sans-serif;
            margin: 0;
            padding: 20px;
            background-color: #f4f4f4;
        }

        h1 {
            text-align: center;
        }

        .subject {
            background: white;
            padding: 20px;
            margin-bottom: 20px;
            border-radius: 10px;
            box-shadow: 0 0 10px rgba(0, 0, 0, 0.1);
        }

        .unit {
            margin: 10px 0;
        }

        .progress-bar {
            background: #ddd;
            border-radius: 20px;
            overflow: hidden;
            margin: 10px 0;
        }

        .progress-bar-fill {
            height: 20px;
            background: #4caf50;
            width: 0%;
            transition: width 0.3s;
        }

        button {
            display: block;
            margin: 20px auto;
            padding: 10px 20px;
            background-color: #4caf50;
            color: white;
            border: none;
            border-radius: 5px;
            cursor: pointer;
        }
    </style>
</head>

<body>

    <h1>My Exam Syllabus Tracker</h1>

    <div class="subject" data-subject="DSBDA">
        <h2>DSBDA</h2>
        <div class="unit"><input type="checkbox" /> Unit 3: Big Data Analytics Life Cycle</div>
        <div class="unit"><input type="checkbox" /> Unit 4: Predictive Big Data Analytics with Python</div>
        <div class="unit"><input type="checkbox" /> Unit 5: Big Data Analytics and Model Evaluation</div>
        <div class="unit"><input type="checkbox" /> Unit 6: Data Visualization and Hadoop</div>
        <div class="progress-bar">
            <div class="progress-bar-fill"></div>
        </div>
    </div>

    <div class="subject" data-subject="WT">
        <h2>WT</h2>
        <div class="unit"><input type="checkbox" /> Unit 3: Java Servlets and XML</div>
        <div class="unit"><input type="checkbox" /> Unit 4: JSP and Web Services</div>
        <div class="unit"><input type="checkbox" /> Unit 5: Server Side Scripting Languages</div>
        <div class="unit"><input type="checkbox" /> Unit 6: Ruby and Rails</div>
        <div class="progress-bar">
            <div class="progress-bar-fill"></div>
        </div>
    </div>

    <div class="subject" data-subject="AI">
        <h2>AI</h2>
        <div class="unit"><input type="checkbox" /> Unit 3: Adversarial Search and Games</div>
        <div class="unit"><input type="checkbox" /> Unit 4: Knowledge</div>
        <div class="unit"><input type="checkbox" /> Unit 5: Reasoning</div>
        <div class="unit"><input type="checkbox" /> Unit 6: Planning</div>
        <div class="progress-bar">
            <div class="progress-bar-fill"></div>
        </div>
    </div>

    <div class="subject" data-subject="CC">
        <h2>CC</h2>
        <div class="unit"><input type="checkbox" /> Unit 3: Virtualization in Cloud Computing</div>
        <div class="unit"><input type="checkbox" /> Unit 4: Cloud Platforms and Cloud Applications</div>
        <div class="unit"><input type="checkbox" /> Unit 5: Security in Cloud Computing</div>
        <div class="unit"><input type="checkbox" /> Unit 6: Advanced Techniques in Cloud Computing</div>
        <div class="progress-bar">
            <div class="progress-bar-fill"></div>
        </div>
    </div>

    <button onclick="saveProgressToFirebase()">Save Progress to Cloud</button>

    <script>
        // Firebase config + init
        const firebaseConfig = {
            apiKey: "AIzaSyASuEsQB4qs57gpnqol9IN0Vzl7mlTepUo",
            authDomain: "syllabus-tracker-e8ba0.firebaseapp.com",
            projectId: "syllabus-tracker-e8ba0",
            storageBucket: "syllabus-tracker-e8ba0.appspot.com",
            messagingSenderId: "898810875690",
            appId: "1:898810875690:web:1058fa575311eb1d4dd853",
            measurementId: "G-ZT2F2SVFHZ"
        };

        firebase.initializeApp(firebaseConfig);
        const db = firebase.firestore();

        // Update progress bar
        function updateProgress(subjectEl) {
            const checkboxes = subjectEl.querySelectorAll("input[type='checkbox']");
            const progressFill = subjectEl.querySelector(".progress-bar-fill");
            let checkedCount = 0;
            checkboxes.forEach(cb => {
                if (cb.checked) checkedCount++;
            });
            const percentage = (checkedCount / checkboxes.length) * 100;
            progressFill.style.width = percentage + "%";
        }

        // Save progress locally
        function saveProgress() {
            const data = {};
            document.querySelectorAll('.subject').forEach(subject => {
                const subjectName = subject.dataset.subject;
                const checkboxes = subject.querySelectorAll("input[type='checkbox']");
                data[subjectName] = [];
                checkboxes.forEach(cb => data[subjectName].push(cb.checked));
            });
            localStorage.setItem("syllabusTracker", JSON.stringify(data));
        }

        // Load progress from local storage
        function loadProgress() {
            const data = JSON.parse(localStorage.getItem("syllabusTracker"));
            if (!data) return;
            document.querySelectorAll('.subject').forEach(subject => {
                const subjectName = subject.dataset.subject;
                                const checkboxes = subject.querySelectorAll("input[type='checkbox']");
                if (data[subjectName]) {
                    data[subjectName].forEach((checked, i) => {
                        if (checkboxes[i]) {
                            checkboxes[i].checked = checked;
                        }
                    });
                }
                updateProgress(subject);
            });
        }

        // Save to Firestore
        async function saveProgressToFirebase() {
            const data = {};
            document.querySelectorAll('.subject').forEach(subject => {
                const subjectName = subject.dataset.subject;
                const checkboxes = subject.querySelectorAll("input[type='checkbox']");
                data[subjectName] = [];
                checkboxes.forEach(cb => data[subjectName].push(cb.checked));
            });

            try {
                await db.collection("users").doc("demoUser").set(data);
                alert("Progress saved to cloud!");
            } catch (error) {
                console.error("Error saving to Firebase:", error);
                alert("Failed to save progress.");
            }
        }

        // Load from Firestore
        async function loadProgressFromFirebase() {
            try {
                const doc = await db.collection("users").doc("demoUser").get();
                if (doc.exists) {
                    const data = doc.data();
                    document.querySelectorAll('.subject').forEach(subject => {
                        const subjectName = subject.dataset.subject;
                        const checkboxes = subject.querySelectorAll("input[type='checkbox']");
                        if (data[subjectName]) {
                            data[subjectName].forEach((checked, i) => {
                                if (checkboxes[i]) {
                                    checkboxes[i].checked = checked;
                                }
                            });
                        }
                        updateProgress(subject);
                    });
                    localStorage.setItem("syllabusTracker", JSON.stringify(data));
                }
            } catch (error) {
                console.error("Error loading from Firebase:", error);
            }
        }

        // Add listeners
        document.querySelectorAll("input[type='checkbox']").forEach(checkbox => {
            checkbox.addEventListener("change", () => {
                const subjectEl = checkbox.closest(".subject");
                updateProgress(subjectEl);
                saveProgress();
            });
        });

        // Init
        loadProgress();
        loadProgressFromFirebase();
    </script>
</body>

</html>

